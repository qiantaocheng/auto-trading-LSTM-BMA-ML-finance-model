# 15ä¸ªå› å­å®Œæ•´é›†æˆ - æœ€ç»ˆç¡®è®¤

## âœ… å®ŒæˆçŠ¶æ€

**æ‰€æœ‰15ä¸ªå› å­å·²æˆåŠŸæ·»åŠ åˆ°è®­ç»ƒå’Œé¢„æµ‹æµç¨‹ï¼**

---

## ğŸ“Š æœ€ç»ˆéªŒè¯ç»“æœ

### å› å­ä¸€è‡´æ€§éªŒè¯
```
T10_ALPHA_FACTORS: 15 factors
t10_selected: 15 factors
Match: True âœ…
All T10_ALPHA_FACTORS in t10_selected: True âœ…
```

### è®­ç»ƒæµç¨‹éªŒè¯
- âœ… ElasticNet: 15ä¸ªå› å­
- âœ… CatBoost: 15ä¸ªå› å­
- âœ… XGBoost: 15ä¸ªå› å­
- âœ… LambdaRank: 15ä¸ªå› å­

### é¢„æµ‹æµç¨‹éªŒè¯
- âœ… Direct Predict (base_features): 15ä¸ªå› å­
- âœ… 80/20 OOS: è‡ªåŠ¨å¯¹é½ï¼Œä½¿ç”¨è®­ç»ƒæ—¶çš„15ä¸ªå› å­

---

## ğŸ“‹ å®Œæ•´15ä¸ªå› å­åˆ—è¡¨

1. `momentum_10d` - 10å¤©çŸ­æœŸåŠ¨é‡
2. `ivol_30` - ç‰¹è´¨æ³¢åŠ¨ç‡ï¼ˆ30å¤©ï¼Œè‡ªåŠ¨ä¸‹è½½SPY/QQQï¼‰
3. `near_52w_high` - æ¥è¿‘52å‘¨é«˜ç‚¹
4. `rsi_21` - RSIæŒ‡æ ‡ï¼ˆ21å¤©ï¼‰
5. `vol_ratio_30d` - æˆäº¤é‡æ¯”ç‡ï¼ˆ30å¤©ï¼‰
6. `trend_r2_60` - è¶‹åŠ¿RÂ²ï¼ˆ60å¤©ï¼‰
7. `liquid_momentum` - æµåŠ¨æ€§åŠ¨é‡
8. `obv_momentum_40d` - OBVåŠ¨é‡ï¼ˆ40å¤©ï¼‰
9. `atr_ratio` - ATRæ¯”ç‡
10. `ret_skew_30d` - æ”¶ç›Šååº¦ï¼ˆ30å¤©ï¼‰
11. `price_ma60_deviation` - ä»·æ ¼MA60åç¦»åº¦
12. `blowoff_ratio_30d` - çˆ†é‡æ¯”ç‡ï¼ˆ30å¤©ï¼‰
13. `feat_vol_price_div_30d` - é‡ä»·èƒŒç¦»å› å­ï¼ˆ30å¤©ï¼‰
14. `5_days_reversal` âœ… **æ–°å¢** - 5å¤©åè½¬å› å­
15. `downside_beta_ewm_21` âœ… **æ–°å¢** - ä¸‹è¡ŒBetaï¼ˆEWM 21å¤©ï¼Œè‡ªåŠ¨ä¸‹è½½QQQï¼‰

---

## ğŸ”§ SPY/QQQ æ•°æ®è‡ªåŠ¨è·å–æœºåˆ¶

### `ivol_30` å› å­
- âœ… **è‡ªåŠ¨ä¸‹è½½ SPY**: å¦‚æœæ•°æ®ä¸­æ²¡æœ‰ SPYï¼Œè‡ªåŠ¨ä» Polygon ä¸‹è½½
- âœ… **QQQ Fallback**: å¦‚æœ SPY ä¸å¯ç”¨ï¼Œä½¿ç”¨ QQQ ä½œä¸ºå¤‡é€‰
- âœ… **å®ç°**: `bma_models/simple_25_factor_engine.py` `_compute_ivol_30()`

### `downside_beta_ewm_21` å› å­
- âœ… **è‡ªåŠ¨ä¸‹è½½ QQQ**: è‡ªåŠ¨ä» Polygon ä¸‹è½½ QQQ æ•°æ®
- âœ… **ç¼“å­˜æœºåˆ¶**: ä½¿ç”¨ `_benchmark_cache` é¿å…é‡å¤ä¸‹è½½
- âœ… **å®ç°**: `bma_models/simple_25_factor_engine.py` `_compute_downside_beta_ewm_21()`

---

## âœ… ä»£ç ä¿®æ”¹æ€»ç»“

### 1. `bma_models/é‡åŒ–æ¨¡å‹_bma_ultra_enhanced.py`

#### t10_selected (Line 3283-3299)
- âœ… æ·»åŠ  `5_days_reversal`
- âœ… æ·»åŠ  `downside_beta_ewm_21`
- âœ… ç°åœ¨åŒ…å«æ‰€æœ‰15ä¸ªå› å­

#### base_features (Line 5356-5364)
- âœ… æ·»åŠ  `5_days_reversal`
- âœ… æ·»åŠ  `downside_beta_ewm_21`
- âœ… ç°åœ¨åŒ…å«æ‰€æœ‰15ä¸ªå› å­

### 2. `bma_models/simple_25_factor_engine.py`

#### `_compute_ivol_30()` (Line 1359-1406)
- âœ… æ”¹è¿›ï¼šå¦‚æœæ•°æ®ä¸­æ²¡æœ‰ SPYï¼Œè‡ªåŠ¨ä» Polygon ä¸‹è½½
- âœ… Fallbackï¼šå¦‚æœ SPY å¤±è´¥ï¼Œä½¿ç”¨ QQQ

#### `_compute_downside_beta_ewm_21()` (Line 1623-1694)
- âœ… æ”¹è¿›ï¼šè‡ªåŠ¨ä» Polygon ä¸‹è½½ QQQï¼ˆå¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ï¼‰
- âœ… æ”¹è¿›é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

---

## ğŸš€ ä¸‹ä¸€æ­¥æ“ä½œ

### æ›´æ–°æ•°æ®æ–‡ä»¶ï¼ˆæ¨èï¼‰

è¿è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°è®¡ç®—æ‰€æœ‰15ä¸ªå› å­ï¼š

```bash
python scripts/verify_and_update_all_factors.py \
    --yes \
    --input-file data/factor_exports/polygon_factors_all_filtered_clean_recalculated.parquet \
    --output-file data/factor_exports/polygon_factors_all_filtered_clean_15factors.parquet \
    --lookback-days 120
```

è¿™å°†ï¼š
- âœ… è‡ªåŠ¨ä¸‹è½½ SPY æ•°æ®ï¼ˆå¦‚æœæ•°æ®ä¸­æ²¡æœ‰ï¼‰
- âœ… é‡æ–°è®¡ç®—æ‰€æœ‰15ä¸ªå› å­
- âœ… ç¡®ä¿æ‰€æœ‰å› å­éƒ½æ­£ç¡®è®¡ç®—
- âœ… æ›´æ–° MultiIndex æ•°æ®æ–‡ä»¶

---

## âœ… éªŒè¯æ¸…å•

- [x] T10_ALPHA_FACTORS åŒ…å«15ä¸ªå› å­
- [x] t10_selected åŒ…å«15ä¸ªå› å­ï¼ˆä¸ T10_ALPHA_FACTORS å®Œå…¨åŒ¹é…ï¼‰
- [x] base_features åŒ…å«15ä¸ªå› å­ï¼ˆä¸ t10_selected å®Œå…¨åŒ¹é…ï¼‰
- [x] æ‰€æœ‰å››ä¸ªç¬¬ä¸€å±‚æ¨¡å‹ä½¿ç”¨15ä¸ªå› å­
- [x] `ivol_30` è‡ªåŠ¨ä¸‹è½½ SPY æ•°æ®
- [x] `downside_beta_ewm_21` è‡ªåŠ¨ä¸‹è½½ QQQ æ•°æ®
- [x] æ‰€æœ‰å› å­è®¡ç®—æ–¹æ³•éƒ½å­˜åœ¨
- [x] æ‰€æœ‰å› å­éƒ½ä½¿ç”¨ `shift(1)` ç”¨äºå¼€ç›˜å‰é¢„æµ‹

---

## ğŸ¯ æœ€ç»ˆçŠ¶æ€

**âœ… æ‰€æœ‰15ä¸ªå› å­å·²æˆåŠŸé›†æˆåˆ°è®­ç»ƒå’Œé¢„æµ‹æµç¨‹ï¼**

- âœ… **è®­ç»ƒ**: æ‰€æœ‰å››ä¸ªç¬¬ä¸€å±‚æ¨¡å‹ä½¿ç”¨15ä¸ªå› å­
- âœ… **é¢„æµ‹**: Direct Predict å’Œ 80/20 OOS ä½¿ç”¨15ä¸ªå› å­
- âœ… **è®¡ç®—**: æ‰€æœ‰15ä¸ªå› å­éƒ½èƒ½æ­£ç¡®è®¡ç®—
- âœ… **æ•°æ®è·å–**: SPY/QQQ æ•°æ®è‡ªåŠ¨è·å–æœºåˆ¶å·²å®ç°

---

**æœ€åæ›´æ–°**: 2025-01-20  
**çŠ¶æ€**: âœ… **å®Œæˆå¹¶éªŒè¯** - æ‰€æœ‰15ä¸ªå› å­å·²æ·»åŠ åˆ°è®­ç»ƒå’Œé¢„æµ‹æµç¨‹ï¼ŒSPY/QQQ æ•°æ®è‡ªåŠ¨è·å–æœºåˆ¶å·²å®ç°
