# 训练阶段跟踪指南

## 📊 当前训练状态

**训练运行**: `run_20260122_213618`  
**开始时间**: 2026-01-22 21:36:18  
**运行时长**: 约17分钟  
**状态**: 🔄 **进行中**

## 🔍 训练阶段详解

### 阶段1: 数据加载和预处理 ⏳ (当前可能在此阶段)

**预计时间**: 5-10分钟

**步骤**:
1. 读取parquet文件 (130MB)
2. 验证MultiIndex格式 (`['date', 'ticker']`)
3. 验证数据完整性
4. 计算/验证特征列
5. 准备target列

**如何判断**:
- 训练目录为空
- Python进程内存 < 1GB
- 运行时间 < 10分钟

### 阶段2: 第一层模型训练（6折CV）

**预计时间**: 60-90分钟

#### 2.1 ElasticNet训练
- **6折交叉验证**: 每次训练约2-3分钟
- **总时间**: 约15-20分钟
- **日志**: `"📊 第一层训练开始"`, `"ElasticNet"`

#### 2.2 XGBoost训练
- **6折交叉验证**: 每次训练约3-5分钟
- **总时间**: 约20-30分钟
- **日志**: `"XGBoost"`

#### 2.3 CatBoost训练
- **6折交叉验证**: 每次训练约3-5分钟
- **总时间**: 约20-30分钟
- **日志**: `"CatBoost"`

#### 2.4 LambdaRank训练
- **6折交叉验证**: 每次训练约5-8分钟
- **总时间**: 约30-50分钟
- **日志**: `"LambdaRank"`

**如何判断**:
- 训练目录仍为空（中间结果不保存）
- Python进程内存 1-3GB
- 运行时间 10-90分钟

### 阶段3: 第二层模型训练

**预计时间**: 10-20分钟

#### 3.1 MetaRankerStacker (Ridge Stacking)
- **训练时间**: 约5-10分钟
- **日志**: `"MetaRankerStacker"`, `"Ridge"`

#### 3.2 LambdaRank Stacker
- **训练时间**: 约5-10分钟
- **日志**: `"LambdaRank Stacker"`

**如何判断**:
- 训练目录仍为空
- Python进程内存 2-4GB
- 运行时间 90-110分钟

### 阶段4: 模型保存和Snapshot创建 ✅

**预计时间**: 2-5分钟

**步骤**:
1. 序列化所有模型
2. 保存到snapshot
3. 生成`snapshot_id.txt`

**如何判断**:
- `snapshot_id.txt`文件出现
- 训练目录有文件
- Python进程即将结束

## 🔍 如何跟踪当前阶段

### 方法1: 检查进程内存使用

```bash
Get-Process python | Select-Object Id, @{Name="Memory(MB)";Expression={[math]::Round($_.WorkingSet64/1MB, 2)}}, @{Name="Runtime";Expression={(Get-Date) - $_.StartTime}}
```

**判断标准**:
- < 500MB: 数据加载阶段
- 500MB - 2GB: 第一层模型训练
- 2GB - 4GB: 第二层模型训练
- 文件出现: 保存阶段

### 方法2: 检查训练目录

```bash
ls results/full_dataset_training/run_20260122_213618/
```

**判断标准**:
- 空目录: 阶段1-3（训练中）
- 有`snapshot_id.txt`: 阶段4（完成）

### 方法3: 检查运行时间

**判断标准**:
- 0-10分钟: 阶段1（数据加载）
- 10-90分钟: 阶段2（第一层训练）
- 90-110分钟: 阶段3（第二层训练）
- 110-120分钟: 阶段4（保存）

## 📋 当前状态估计

基于当前信息：
- **运行时长**: 17分钟
- **目录状态**: 空（无文件）
- **进程内存**: ~466MB

**估计**: 可能处于**阶段1末尾**或**阶段2开始**（第一层模型训练初期）

## 🎯 下一步检查

1. **等待10-20分钟**: 如果仍在阶段1，应该很快进入阶段2
2. **检查内存增长**: 如果内存增长到1GB+，说明进入阶段2
3. **检查snapshot文件**: 如果出现`snapshot_id.txt`，说明完成

---

**创建时间**: 2026-01-22  
**当前阶段**: 估计在阶段1（数据加载）或阶段2初期（第一层训练开始）
